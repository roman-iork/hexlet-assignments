# Docker

Docker — это программное обеспечение для автоматизации развёртывания и управления приложениями в средах с поддержкой контейнеризации. В этом домашнем задании мы познакомимся с Docker и упакуем простое приложение на Spring boot в контейнер.

## Ссылки

* [Установка Docker](https://docs.docker.com/engine/install/)
* [Как и для чего использовать Docker](https://guides.hexlet.io/ru/docker/)
* [Введение в Docker](https://www.youtube.com/watch?v=dfXuTTV6TVo)

## Установка

Для выполнения этого задания вам понадобится установленный Docker

## Задачи

* Установите Docker, следуя инструкции для своей операционной системы

## app

В директории *app* находится очень простое Spring boot приложение. Все, что оно делает – это выводит приветствие при запросе к корневой странице. Приложение стартует на порту 8080

## Задачи

* Изучите код этого приложения, его мы будем упаковывать в контейнер.

## Dockerfile

* Запишите в *Dockerfile* команды для упаковки приложения в образ.

  При создании своего образа унаследуйтесть от образа `eclipse-temurin:20-jdk`. Внутри уже есть установленные jdk20, но нет Gradle. Так как для сборки приложения мы используем Gradle, нужно будет его установить вручную. Как это делается, можно посмотреть в [документации](https://gradle.org/install/#manually). Или просто добавьте код из примера ниже:

  ```dockerfile
  ARG GRADLE_VERSION=8.2

  RUN apt-get update && apt-get install -yq make unzip

  RUN wget -q https://services.gradle.org/distributions/gradle-${GRADLE_VERSION}-bin.zip \
      && unzip gradle-${GRADLE_VERSION}-bin.zip \
      && rm gradle-${GRADLE_VERSION}-bin.zip

  ENV GRADLE_HOME=/opt/gradle

  RUN mv gradle-${GRADLE_VERSION} ${GRADLE_HOME}

  ENV PATH=$PATH:$GRADLE_HOME/bin
  ```

  При старте контейнера должно запускаться приложение. Приложение должно быть доступно снаружи контейнера на порту 3000.

* Соберите образ при помощи команды:

  ```bash
  docker build -t <image> .
  ```

  С помощью флага -t передается имя образа, включая имя аккаунта и тег.

* После сборки образа вы сможете увидеть его в списке образов. Выполните команду `docker images` и найдите там свой образ.

* Запустите контейнер при помощи команды:

  ```bash
  docker run -it -p 3000:8080 <image>
  ```

  Так как приложение внутри контейнера запускается на порту 8080, а снаружи контейнера оно должно быть доступно на порту 3000, нам нужно сопоставить порт 8080 внутри контейнера с портом 3000 на вашем компьютере. Это делается при помощи флага `-p`

* Откройте браузер и загрузите страницу *http://localhost:3000*. Убедитесь, что все работает. Если все сделано верно, вы увидите приветствие.

* Остановите образ при помощи комбинации клавиш Ctrl + C. После этого приложение станет недоступно.

* Мы также можем запустить образ и подключиться к нему при помощи команды:

  ```bash
  docker run -it -p 3000:8080 <image> bash
  ```

  Запустится bash сессия внутри контейнера. Изучите файловую систему внутри контейнера. Протестируйте наше приложение, запустите тесты при помощи команды `gradle test`. Выйти из контейнера можно при помощи комбинации клавиш Ctrl + D

## Подсказки

* Изучите файлы с примерами в директории *Examples*

* Не забывайте, что внутри контейнера теперь доступен gradle, который поможет вам собрать и запустить приложение
